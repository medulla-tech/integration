dn: cn=config
changetype: modify
replace: olcServerID
{% for item in CLUSTER_SERVERS_LIST %}
olcServerID: {{ item }}
{% endfor %}

dn: olcDatabase={0}config,cn=config
changetype: modify
add: olcSyncRepl
{% for itemnb in CLUSTER_SERVERS_LIST -%}
olcSyncRepl:
    rid=00{{ itemnb }}
    provider={{ CLUSTER_SERVERS_LIST[itemnb].split(' ')[1] }}
    bindmethod=simple
    binddn="cn=admin,{{ LDAP_BASEDN }}"
    credentials={{ LDAPADMINPASSWD }}
    searchbase="cn=config"
    type=refreshAndPersist
    retry="5 5 300 5"
    timeout=1
    starttls=critical
    tls_reqcert=demand
{% endfor %}
-
add: olcMultiProvider
olcMultiProvider: TRUE
